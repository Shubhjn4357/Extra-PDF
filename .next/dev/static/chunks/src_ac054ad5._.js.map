{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/components/ui/AIInput.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Sparkles, ArrowRight } from 'lucide-react';\r\n\r\ninterface AIInputProps {\r\n  onSubmit: (text: string) => void;\r\n  placeholder?: string;\r\n  isThinking?: boolean;\r\n}\r\n\r\nexport const AIInput: React.FC<AIInputProps> = ({ onSubmit, placeholder = \"Describe a PDF to create or edit...\", isThinking }) => {\r\n  const [value, setValue] = useState('');\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (value.trim()) {\r\n      onSubmit(value);\r\n      setValue('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto\">\r\n      <div className=\"relative group\">\r\n        {/* Glow Effect */}\r\n        <div className=\"absolute -inset-0.5 bg-gradient-to-r from-red-500 to-orange-500 rounded-[2rem] blur opacity-30 group-hover:opacity-60 transition duration-1000 group-hover:duration-200\" />\r\n        \r\n        <form onSubmit={handleSubmit} className=\"relative flex items-center\">\r\n          <input \r\n            type=\"text\"\r\n            value={value}\r\n            onChange={(e) => setValue(e.target.value)}\r\n            disabled={isThinking}\r\n            placeholder={isThinking ? \"Thinking...\" : placeholder}\r\n            className=\"\r\n              block w-full bg-white/70 dark:bg-black/70 backdrop-blur-xl border border-white/20 dark:border-white/10\r\n              rounded-[2rem] py-4 pl-8 pr-16 text-lg shadow-xl \r\n              focus:ring-2 focus:ring-red-500/50 focus:border-red-500/50 focus:outline-none \r\n              transition-all disabled:opacity-50 text-foreground placeholder:text-muted-foreground/70\r\n            \"\r\n          />\r\n          <button \r\n            type=\"submit\"\r\n            disabled={!value.trim() || isThinking}\r\n            className=\"\r\n              absolute right-2 top-2 bottom-2 aspect-square rounded-full \r\n              bg-gradient-to-tr from-red-600 to-orange-500 text-white shadow-lg\r\n              hover:shadow-red-500/30 disabled:opacity-50 disabled:shadow-none\r\n              flex items-center justify-center transition-all hover:scale-105 active:scale-95\r\n            \"\r\n          >\r\n            {isThinking ? (\r\n                <Sparkles className=\"w-5 h-5 animate-spin\" />\r\n            ) : (\r\n                <ArrowRight className=\"w-5 h-5\" />\r\n            )}\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;;;;;AAQO,MAAM,UAAkC,CAAC,EAAE,QAAQ,EAAE,cAAc,qCAAqC,EAAE,UAAU,EAAE;;IAC3H,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wRAAQ,EAAC;IAEnC,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,IAAI,MAAM,IAAI,IAAI;YAChB,SAAS;YACT,SAAS;QACX;IACF;IAEA,qBACE,4SAAC;QAAI,WAAU;kBACb,cAAA,4SAAC;YAAI,WAAU;;8BAEb,4SAAC;oBAAI,WAAU;;;;;;8BAEf,4SAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACtC,4SAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,UAAU;4BACV,aAAa,aAAa,gBAAgB;4BAC1C,WAAU;;;;;;sCAOZ,4SAAC;4BACC,MAAK;4BACL,UAAU,CAAC,MAAM,IAAI,MAAM;4BAC3B,WAAU;sCAOT,2BACG,4SAAC,6SAAQ;gCAAC,WAAU;;;;;yFAEpB,4SAAC,uTAAU;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOtC;GAnDa;KAAA"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/utils/polyfill.js"],"sourcesContent":["\r\n\r\n// console.log(\"POLYFILL RUNNING\");\r\n// if (typeof window === 'undefined') {\r\n//     global.Buffer = global.Buffer || require('buffer').Buffer;\r\n//     global.DOMMatrix = global.DOMMatrix || class DOMMatrix {\r\n//         constructor() { this.a = 1; this.b = 0; this.c = 0; this.d = 1; this.e = 0; this.f = 0; }\r\n//     };\r\n//     global.Image = global.Image || class Image { };\r\n//     global.HTMLCanvasElement = global.HTMLCanvasElement || class HTMLCanvasElement { };\r\n//     global.ImageData = global.ImageData || class ImageData { };\r\n//     global.performance = global.performance || require('perf_hooks').performance;\r\n// } else if (!window.Buffer) {\r\n//     window.Buffer = require('buffer').Buffer;\r\n// }\r\n"],"names":[],"mappings":"AAEA,mCAAmC;AACnC,uCAAuC;AACvC,iEAAiE;AACjE,+DAA+D;AAC/D,oGAAoG;AACpG,SAAS;AACT,sDAAsD;AACtD,0FAA0F;AAC1F,kEAAkE;AAClE,oFAAoF;AACpF,+BAA+B;AAC/B,gDAAgD;AAChD,IAAI"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/services/tools/convertTools.ts"],"sourcesContent":["import { Document, Packer, Paragraph, TextRun } from 'docx';\r\nimport { PDFDocument, rgb } from 'pdf-lib';\r\n// @ts-ignore\r\nimport * as XLSX from 'xlsx';\r\n\r\n// @ts-ignore\r\nimport Tesseract from 'tesseract.js';\r\n// @ts-ignore\r\nimport mammoth from 'mammoth';\r\n// @ts-ignore\r\nimport html2canvas from 'html2canvas';\r\n// @ts-ignore\r\nimport { jsPDF } from 'jspdf';\r\n\r\n// Worker initialized in components\r\n\r\n\r\n// --- PDF TO OFFICE ---\r\n\r\nexport const createDocxFromText = async (text: string): Promise<Blob> => {\r\n    const doc = new Document({\r\n        sections: [{\r\n            children: text.split('\\n').map(line =>\r\n                new Paragraph({ children: [new TextRun(line)], spacing: { after: 200 } })\r\n            ),\r\n        }],\r\n    });\r\n    return await Packer.toBlob(doc);\r\n};\r\n\r\nexport const createXlsxFromPdf = async (file: File): Promise<Blob> => {\r\n    const { pdfjs } = await import('react-pdf');\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const pdf = await pdfjs.getDocument(arrayBuffer).promise;\r\n    const allData: string[][] = [];\r\n\r\n    for (let i = 1; i <= pdf.numPages; i++) {\r\n        const page = await pdf.getPage(i);\r\n        const textContent = await page.getTextContent();\r\n        const pageText = textContent.items.map((item: any) => item.str).join(' ');\r\n\r\n        // Simple heuristic: Try to split by common CSV delimiters or double spaces if structure is simple\r\n        // For complex PDF tables, this is a best-effort client-side extraction.\r\n        const rows = pageText.split('\\n');\r\n        rows.forEach(r => {\r\n            allData.push(r.split(/\\s{2,}/)); // Split by 2+ spaces\r\n        });\r\n    }\r\n\r\n    const ws = XLSX.utils.aoa_to_sheet(allData);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, \"Sheet1\");\r\n    const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\r\n    return new Blob([wbout], { type: 'application/octet-stream' });\r\n};\r\n\r\nexport const createPptxFromPdf = async (file: File): Promise<Blob> => {\r\n    // @ts-ignore\r\n    const PptxGenJSModule = await import('pptxgenjs');\r\n    const PptxGenJS = PptxGenJSModule.default || PptxGenJSModule;\r\n    const pres = new PptxGenJS();\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const { pdfjs } = await import('react-pdf');\r\n    const pdf = await pdfjs.getDocument(arrayBuffer).promise;\r\n\r\n    for (let i = 1; i <= pdf.numPages; i++) {\r\n        const slide = pres.addSlide();\r\n        const page = await pdf.getPage(i);\r\n        const textContent = await page.getTextContent();\r\n\r\n        // Add extracted text to slide\r\n        const str = textContent.items.map((item: any) => item.str).join(' ');\r\n        // Truncate to avoid overflow for demo\r\n        slide.addText(str.substring(0, 1000), { x: 0.5, y: 0.5, w: '90%', h: '80%', fontSize: 12 });\r\n        slide.addText(`Page ${i}`, { x: 0.5, y: '90%', fontSize: 10, color: '808080' });\r\n    }\r\n\r\n    return (await pres.write({ outputType: 'blob' })) as Blob;\r\n};\r\n\r\n// --- OFFICE TO PDF (Client Side Simulation/Best Effort) ---\r\n\r\nexport const wordToPdf = async (file: File): Promise<Uint8Array> => {\r\n    // Uses mammoth to extract raw text from .docx and put it in a PDF\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const result = await mammoth.extractRawText({ arrayBuffer });\r\n    const text = result.value;\r\n\r\n    // Create simple PDF from text\r\n    const pdfDoc = await PDFDocument.create();\r\n    let page = pdfDoc.addPage();\r\n    const { width, height } = page.getSize();\r\n    const fontSize = 12;\r\n\r\n    // Simple text wrapping logic\r\n    const lines = text.split('\\n');\r\n    let y = height - 50;\r\n\r\n    for (const line of lines) {\r\n        if (y < 50) { page = pdfDoc.addPage(); y = height - 50; }\r\n        // Very basic truncation to prevent error\r\n        const cleanLine = line.replace(/[^\\x00-\\x7F]/g, \"\");\r\n        page.drawText(cleanLine.substring(0, 90), { x: 50, y, size: fontSize });\r\n        y -= 15;\r\n    }\r\n\r\n    return await pdfDoc.save();\r\n};\r\n\r\nexport const convertImageOrOfficeToPdf = async (file: File): Promise<Uint8Array> => {\r\n    // Wrapper to handle different types\r\n    if (file.name.endsWith('.docx')) return wordToPdf(file);\r\n    if (file.name.endsWith('.pptx') || file.name.endsWith('.xlsx')) {\r\n        // Fallback for PPT/Excel client side (Convert to Text PDF)\r\n        // Real implementation requires heavy parsers not available in standard ESM CDN\r\n        const pdfDoc = await PDFDocument.create();\r\n        const page = pdfDoc.addPage();\r\n        page.drawText(`Conversion of ${file.name} to PDF.\\n(Preview only supports Text extraction for this format on mobile/web)`, { x: 50, y: 700, size: 12 });\r\n        return await pdfDoc.save();\r\n    }\r\n    return imageToPdf(file);\r\n};\r\n\r\n// --- HTML TO PDF ---\r\n\r\nexport const htmlToPdf = async (htmlContent: string): Promise<Uint8Array> => {\r\n    // Create a temporary container\r\n    const container = document.createElement('div');\r\n    container.innerHTML = htmlContent;\r\n    container.style.width = '595px'; // A4 width approx\r\n    container.style.padding = '20px';\r\n    container.style.background = 'white';\r\n    document.body.appendChild(container);\r\n\r\n    try {\r\n        const canvas = await html2canvas(container);\r\n        const imgData = canvas.toDataURL('image/png');\r\n\r\n        const pdf = new jsPDF();\r\n        const imgProps = pdf.getImageProperties(imgData);\r\n        const pdfWidth = pdf.internal.pageSize.getWidth();\r\n        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;\r\n\r\n        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);\r\n        return new Uint8Array(pdf.output('arraybuffer'));\r\n    } finally {\r\n        document.body.removeChild(container);\r\n    }\r\n};\r\n\r\n// --- UTILS ---\r\n\r\nexport const repairPdf = async (file: File): Promise<Uint8Array> => {\r\n    // PDF-lib's ignoreEncryption option can sometimes bypass basic corruption or owner passwords\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const pdfDoc = await PDFDocument.load(arrayBuffer, { ignoreEncryption: true });\r\n    return await pdfDoc.save();\r\n};\r\n\r\nexport const ocrPdf = async (file: File): Promise<string> => {\r\n    const images = await pdfToImages(file);\r\n    if (images.length === 0) return \"\";\r\n\r\n    const worker = await Tesseract.createWorker('eng');\r\n    let fullText = \"\";\r\n\r\n    for (const img of images) {\r\n        const ret = await worker.recognize(img);\r\n        fullText += ret.data.text + \"\\n\\n\";\r\n    }\r\n    await worker.terminate();\r\n    return fullText;\r\n};\r\n\r\n// --- EXISTING IMAGE TOOLS ---\r\n\r\nexport const getPageImage = async (file: File, pageNum: number): Promise<string> => {\r\n    const { pdfjs } = await import('react-pdf');\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const pdf = await pdfjs.getDocument(arrayBuffer).promise;\r\n    const page = await pdf.getPage(pageNum);\r\n    const viewport = page.getViewport({ scale: 1.5 }); // Good balance for AI analysis\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = viewport.width;\r\n    canvas.height = viewport.height;\r\n\r\n    const context = canvas.getContext('2d');\r\n    if (context) {\r\n        await page.render({ canvasContext: context, viewport } as any).promise;\r\n        return canvas.toDataURL('image/jpeg', 0.8);\r\n    }\r\n    throw new Error(\"Canvas context error\");\r\n}\r\n\r\nexport const pdfToImages = async (file: File): Promise<string[]> => {\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    // Use the configured library from react-pdf\r\n    const { pdfjs } = await import('react-pdf');\r\n    const pdf = await pdfjs.getDocument(arrayBuffer).promise;\r\n    const images: string[] = [];\r\n\r\n    for (let i = 1; i <= pdf.numPages; i++) {\r\n        const page = await pdf.getPage(i);\r\n        const viewport = page.getViewport({ scale: 2.0 }); // Higher scale for better quality\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = viewport.width;\r\n        canvas.height = viewport.height;\r\n\r\n        const context = canvas.getContext('2d');\r\n        if (context) {\r\n            // Cast to any to handle potential type mismatch with RenderParameters\r\n            await page.render({ canvasContext: context, viewport } as any).promise;\r\n            images.push(canvas.toDataURL('image/jpeg', 0.8));\r\n        }\r\n    }\r\n    return images;\r\n};\r\n\r\nexport const createPdfFromImages = async (files: File[]): Promise<Uint8Array> => {\r\n    const pdfDoc = await PDFDocument.create();\r\n\r\n    for (const file of files) {\r\n        const buffer = await file.arrayBuffer();\r\n        let img;\r\n        try {\r\n            if (file.type === 'image/jpeg' || file.type === 'image/jpg') {\r\n                img = await pdfDoc.embedJpg(buffer);\r\n            } else if (file.type === 'image/png') {\r\n                img = await pdfDoc.embedPng(buffer);\r\n            } else {\r\n                continue;\r\n            }\r\n        } catch (e) {\r\n            console.warn(`Skipping invalid image: ${file.name}`);\r\n            continue;\r\n        }\r\n\r\n        // Add page matching image dimensions\r\n        const page = pdfDoc.addPage([img.width, img.height]);\r\n        page.drawImage(img, {\r\n            x: 0,\r\n            y: 0,\r\n            width: img.width,\r\n            height: img.height,\r\n        });\r\n    }\r\n\r\n    if (pdfDoc.getPageCount() === 0) {\r\n        throw new Error(\"No valid images were found to create PDF.\");\r\n    }\r\n\r\n    return await pdfDoc.save();\r\n};\r\n\r\nexport const imageToPdf = async (file: File): Promise<Uint8Array> => {\r\n    return createPdfFromImages([file]);\r\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 433, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/services/storage.ts"],"sourcesContent":["// Simple IndexedDB helpers for storing last opened PDF bytes\r\nexport const saveFileToIDB = async (key: string, bytes: Uint8Array, name?: string) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n        const openReq = indexedDB.open('extrapdf_db', 1);\r\n        openReq.onupgradeneeded = () => {\r\n            const db = openReq.result;\r\n            if (!db.objectStoreNames.contains('files')) db.createObjectStore('files');\r\n        };\r\n        openReq.onsuccess = () => {\r\n            const db = openReq.result;\r\n            const tx = db.transaction('files', 'readwrite');\r\n            const store = tx.objectStore('files');\r\n            store.put({ name: name || 'document.pdf', bytes: Array.from(bytes) }, key);\r\n            tx.oncomplete = () => { db.close(); resolve(); };\r\n            tx.onerror = () => { db.close(); reject(tx.error); };\r\n        };\r\n        openReq.onerror = () => reject(openReq.error);\r\n    });\r\n};\r\n\r\nexport const loadFileFromIDB = async (key: string): Promise<{ name: string, bytes: Uint8Array } | null> => {\r\n    return new Promise((resolve, reject) => {\r\n        const openReq = indexedDB.open('extrapdf_db', 1);\r\n        openReq.onupgradeneeded = () => {\r\n            const db = openReq.result;\r\n            if (!db.objectStoreNames.contains('files')) db.createObjectStore('files');\r\n        };\r\n        openReq.onsuccess = () => {\r\n            const db = openReq.result;\r\n            const tx = db.transaction('files', 'readonly');\r\n            const store = tx.objectStore('files');\r\n            const getReq = store.get(key);\r\n            getReq.onsuccess = () => {\r\n                const val = getReq.result;\r\n                db.close();\r\n                if (!val) return resolve(null);\r\n                resolve({ name: val.name, bytes: new Uint8Array(val.bytes) });\r\n            };\r\n            getReq.onerror = () => { db.close(); reject(getReq.error); };\r\n        };\r\n        openReq.onerror = () => reject(openReq.error);\r\n    });\r\n};\r\n\r\nexport const clearIDB = async (key: string) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n        const openReq = indexedDB.open('extrapdf_db', 1);\r\n        openReq.onsuccess = () => {\r\n            const db = openReq.result;\r\n            const tx = db.transaction('files', 'readwrite');\r\n            const store = tx.objectStore('files');\r\n            store.delete(key);\r\n            tx.oncomplete = () => { db.close(); resolve(); };\r\n            tx.onerror = () => { db.close(); reject(tx.error); };\r\n        };\r\n        openReq.onerror = () => reject(openReq.error);\r\n    });\r\n};\r\n"],"names":[],"mappings":"AAAA,6DAA6D;;;;;;;;;AACtD,MAAM,gBAAgB,OAAO,KAAa,OAAmB;IAChE,OAAO,IAAI,QAAc,CAAC,SAAS;QAC/B,MAAM,UAAU,UAAU,IAAI,CAAC,eAAe;QAC9C,QAAQ,eAAe,GAAG;YACtB,MAAM,KAAK,QAAQ,MAAM;YACzB,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,UAAU,GAAG,iBAAiB,CAAC;QACrE;QACA,QAAQ,SAAS,GAAG;YAChB,MAAM,KAAK,QAAQ,MAAM;YACzB,MAAM,KAAK,GAAG,WAAW,CAAC,SAAS;YACnC,MAAM,QAAQ,GAAG,WAAW,CAAC;YAC7B,MAAM,GAAG,CAAC;gBAAE,MAAM,QAAQ;gBAAgB,OAAO,MAAM,IAAI,CAAC;YAAO,GAAG;YACtE,GAAG,UAAU,GAAG;gBAAQ,GAAG,KAAK;gBAAI;YAAW;YAC/C,GAAG,OAAO,GAAG;gBAAQ,GAAG,KAAK;gBAAI,OAAO,GAAG,KAAK;YAAG;QACvD;QACA,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;IAChD;AACJ;AAEO,MAAM,kBAAkB,OAAO;IAClC,OAAO,IAAI,QAAQ,CAAC,SAAS;QACzB,MAAM,UAAU,UAAU,IAAI,CAAC,eAAe;QAC9C,QAAQ,eAAe,GAAG;YACtB,MAAM,KAAK,QAAQ,MAAM;YACzB,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,UAAU,GAAG,iBAAiB,CAAC;QACrE;QACA,QAAQ,SAAS,GAAG;YAChB,MAAM,KAAK,QAAQ,MAAM;YACzB,MAAM,KAAK,GAAG,WAAW,CAAC,SAAS;YACnC,MAAM,QAAQ,GAAG,WAAW,CAAC;YAC7B,MAAM,SAAS,MAAM,GAAG,CAAC;YACzB,OAAO,SAAS,GAAG;gBACf,MAAM,MAAM,OAAO,MAAM;gBACzB,GAAG,KAAK;gBACR,IAAI,CAAC,KAAK,OAAO,QAAQ;gBACzB,QAAQ;oBAAE,MAAM,IAAI,IAAI;oBAAE,OAAO,IAAI,WAAW,IAAI,KAAK;gBAAE;YAC/D;YACA,OAAO,OAAO,GAAG;gBAAQ,GAAG,KAAK;gBAAI,OAAO,OAAO,KAAK;YAAG;QAC/D;QACA,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;IAChD;AACJ;AAEO,MAAM,WAAW,OAAO;IAC3B,OAAO,IAAI,QAAc,CAAC,SAAS;QAC/B,MAAM,UAAU,UAAU,IAAI,CAAC,eAAe;QAC9C,QAAQ,SAAS,GAAG;YAChB,MAAM,KAAK,QAAQ,MAAM;YACzB,MAAM,KAAK,GAAG,WAAW,CAAC,SAAS;YACnC,MAAM,QAAQ,GAAG,WAAW,CAAC;YAC7B,MAAM,MAAM,CAAC;YACb,GAAG,UAAU,GAAG;gBAAQ,GAAG,KAAK;gBAAI;YAAW;YAC/C,GAAG,OAAO,GAAG;gBAAQ,GAAG,KAAK;gBAAI,OAAO,GAAG,KAAK;YAAG;QACvD;QACA,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;IAChD;AACJ"}},
    {"offset": {"line": 525, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/store/useFileStore.ts"],"sourcesContent":["import '@/utils/polyfill';\r\nimport { create } from 'zustand';\r\nimport { Annotation, EditableBlock } from '@/types';\r\n// @ts-ignore\r\nimport Tesseract from 'tesseract.js';\r\nimport * as Convert from '@/services/tools/convertTools';\r\nimport { saveFileToIDB, loadFileFromIDB, clearIDB } from '@/services/storage';\r\n\r\n// Worker initialized in components\r\n\r\n\r\ninterface FileState {\r\n  file: File | null;\r\n  fileName: string | null;\r\n  pdfText: string;\r\n  annotations: Annotation[];\r\n  editableBlocks: EditableBlock[]; // New: Stores OCR/Extracted blocks\r\n  numPages: number;\r\n  pageRotations: Record<number, number>;\r\n  isRestoring: boolean; // New: Loading state\r\n\r\n  // Actions\r\n  setFile: (file: File | null) => void;\r\n  // ... other actions\r\n  replaceFile: (newFileBytes: Uint8Array, name?: string) => void;\r\n  setPdfText: (text: string) => void;\r\n  addAnnotation: (ann: Annotation) => void;\r\n  updateAnnotation: (id: string, val: Partial<Annotation>) => void;\r\n  removeAnnotation: (id: string) => void;\r\n  setNumPages: (n: number) => void;\r\n  rotatePage: (page: number) => void;\r\n\r\n  // Block Actions\r\n  updateBlock: (id: string, val: Partial<EditableBlock>) => void;\r\n  deleteBlock: (id: string) => void;\r\n\r\n  reset: () => void;\r\n  // Async Actions\r\n  extractAllText: (file: File) => Promise<void>;\r\n  scanPageForBlocks: (pageNum: number) => Promise<void>;\r\n  persistState: () => Promise<void>;\r\n  restoreState: () => Promise<void>;\r\n}\r\n\r\nexport const useFileStore = create<FileState>((set, get) => ({\r\n  file: null,\r\n  fileName: null,\r\n  pdfText: \"\",\r\n  annotations: [],\r\n  editableBlocks: [],\r\n  numPages: 0,\r\n  pageRotations: {},\r\n  isRestoring: true, // Start as true\r\n\r\n  setFile: (file) => set({\r\n    file,\r\n    fileName: file?.name || null,\r\n    annotations: [],\r\n    editableBlocks: [],\r\n    pageRotations: {},\r\n    pdfText: \"\",\r\n    isRestoring: false,\r\n  }),\r\n\r\n  replaceFile: (newFileBytes, name) => {\r\n    const currentFile = get().file;\r\n    const newName = name || currentFile?.name || 'document.pdf';\r\n    const blob = new Blob([Buffer.from(newFileBytes)], { type: 'application/pdf' });\r\n    const newFile = new File([blob], newName, { type: 'application/pdf' });\r\n    set({\r\n      file: newFile,\r\n      fileName: newName,\r\n      annotations: [],\r\n      editableBlocks: [],\r\n      pageRotations: {},\r\n      pdfText: \"\"\r\n    });\r\n    // persist updated file bytes\r\n    try { saveFileToIDB('lastFile', newFileBytes, newName); } catch (e) { }\r\n  },\r\n\r\n  setPdfText: (text) => set({ pdfText: text }),\r\n\r\n  addAnnotation: (ann) => set((state) => ({ annotations: [...state.annotations, ann] })),\r\n\r\n  updateAnnotation: (id, val) => set((state) => ({\r\n    annotations: state.annotations.map((a) => (a.id === id ? { ...a, ...val } as Annotation : a))\r\n  })),\r\n\r\n  removeAnnotation: (id) => set((state) => ({\r\n    annotations: state.annotations.filter((a) => a.id !== id)\r\n  })),\r\n\r\n  updateBlock: (id, val) => set((state) => ({\r\n    editableBlocks: state.editableBlocks.map(b => b.id === id ? { ...b, ...val, isDirty: true } : b)\r\n  })),\r\n\r\n  deleteBlock: (id) => set((state) => ({\r\n    editableBlocks: state.editableBlocks.filter(b => b.id !== id)\r\n  })),\r\n\r\n  setNumPages: (n) => set({ numPages: n }),\r\n\r\n  rotatePage: (page) => set((state) => ({\r\n    pageRotations: {\r\n      ...state.pageRotations,\r\n      [page]: ((state.pageRotations[page] || 0) + 90) % 360\r\n    }\r\n  })),\r\n\r\n  reset: () => set({\r\n    file: null, fileName: null, pdfText: \"\", annotations: [], editableBlocks: [], numPages: 0, pageRotations: {}, isRestoring: false\r\n  }),\r\n\r\n  persistState: async () => {\r\n    try {\r\n      const s = {\r\n        annotations: get().annotations,\r\n        editableBlocks: get().editableBlocks,\r\n        pageRotations: get().pageRotations,\r\n        pdfText: get().pdfText,\r\n        numPages: get().numPages,\r\n        fileName: get().fileName\r\n      };\r\n      localStorage.setItem('extrapdf_state', JSON.stringify(s));\r\n      const f = get().file;\r\n      if (f) {\r\n        const bytes = new Uint8Array(await f.arrayBuffer());\r\n        await saveFileToIDB('lastFile', bytes, f.name);\r\n      }\r\n    } catch (e) { console.error('Persist Error', e); }\r\n  },\r\n\r\n  restoreState: async () => {\r\n    set({ isRestoring: true });\r\n    try {\r\n      // Initialize Worker Globally if not set\r\n      if (typeof window !== 'undefined') {\r\n        import('@/utils/pdfWorker').then(({ initPdfWorker }) => initPdfWorker());\r\n      }\r\n\r\n      const raw = localStorage.getItem('extrapdf_state');\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        set({\r\n          annotations: parsed.annotations || [],\r\n          editableBlocks: parsed.editableBlocks || [],\r\n          pageRotations: parsed.pageRotations || {},\r\n          pdfText: parsed.pdfText || '',\r\n          numPages: parsed.numPages || 0,\r\n          fileName: parsed.fileName || null\r\n        });\r\n      }\r\n      const fileEntry = await loadFileFromIDB('lastFile');\r\n      if (fileEntry && fileEntry.bytes) {\r\n        const blob = new Blob([Buffer.from(fileEntry.bytes)], { type: 'application/pdf' });\r\n        const f = new File([blob], fileEntry.name, { type: 'application/pdf' });\r\n        set({ file: f, fileName: fileEntry.name });\r\n      }\r\n    } catch (e) {\r\n      console.error('Restore Error', e);\r\n    } finally {\r\n      set({ isRestoring: false });\r\n    }\r\n  },\r\n\r\n  extractAllText: async (file) => {\r\n    try {\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      const { pdfjs } = await import('react-pdf');\r\n      const pdf = await pdfjs.getDocument(arrayBuffer).promise;\r\n\r\n      let fullText = \"\";\r\n      for (let i = 1; i <= pdf.numPages; i++) {\r\n        const page = await pdf.getPage(i);\r\n        const textContent = await page.getTextContent();\r\n\r\n        let lastY = -1;\r\n        const pageText = textContent.items.map((item: any) => {\r\n          let str = item.str;\r\n          if (lastY !== -1 && Math.abs(item.transform[5] - lastY) > 5) {\r\n            str = '\\n' + str;\r\n          }\r\n          lastY = item.transform[5];\r\n          return str;\r\n        }).join(' ');\r\n\r\n        fullText += `--- Page ${i} ---\\n${pageText}\\n\\n`;\r\n      }\r\n      set({ pdfText: fullText });\r\n    } catch (error) {\r\n      console.error(\"Error extracting text:\", error);\r\n    }\r\n  },\r\n\r\n  scanPageForBlocks: async (pageNum: number) => {\r\n    const { file, editableBlocks } = get();\r\n    if (!file) return;\r\n\r\n    // Clear existing blocks for this page to avoid duplicates\r\n    set({ editableBlocks: editableBlocks.filter(b => b.page !== pageNum) });\r\n\r\n    try {\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      const { pdfjs } = await import('react-pdf');\r\n      const pdf = await pdfjs.getDocument(arrayBuffer).promise;\r\n      const page = await pdf.getPage(pageNum);\r\n      const viewport = page.getViewport({ scale: 1.0 });\r\n\r\n      const textContent = await page.getTextContent();\r\n\r\n      const newBlocks: EditableBlock[] = [];\r\n\r\n      // 1. Try Native Text Extraction\r\n      if (textContent.items.length > 0) {\r\n        console.log(\"Native text found, extracting...\");\r\n        // Group items by line roughly\r\n        textContent.items.forEach((item: any, idx: number) => {\r\n          if (!item.str.trim()) return;\r\n          // PDF coords (bottom-left) to Viewport coords (top-left)\r\n          // item.transform: [scaleX, skewX, skewY, scaleY, x, y]\r\n          const tx = item.transform;\r\n          const x = tx[4];\r\n          const y = viewport.height - tx[5] - item.height;\r\n\r\n          newBlocks.push({\r\n            id: `native_${pageNum}_${idx}`,\r\n            page: pageNum,\r\n            x: x,\r\n            y: y,\r\n            text: item.str,\r\n            width: item.width,\r\n            height: item.height || tx[0], // fallback to scaleY\r\n            fontSize: tx[0] || 12, // approx font size from scale\r\n            fontFamily: 'Helvetica',\r\n          });\r\n        });\r\n      } else {\r\n        // 2. Fallback to OCR (Tesseract)\r\n        console.log(\"No native text, running OCR...\");\r\n        const imgData = await Convert.getPageImage(file, pageNum);\r\n\r\n        const worker = await Tesseract.createWorker('eng');\r\n        const { data } = await worker.recognize(imgData);\r\n        await worker.terminate();\r\n\r\n        // Canvas dimensions vs Tesseract dimensions mapping\r\n        // Convert.getPageImage uses scale 1.5, so we need to adjust\r\n        const scaleFactor = 1.5;\r\n\r\n        (data as any).words.forEach((w: any, idx: number) => {\r\n          newBlocks.push({\r\n            id: `ocr_${pageNum}_${idx}`,\r\n            page: pageNum,\r\n            x: w.bbox.x0 / scaleFactor,\r\n            y: w.bbox.y0 / scaleFactor,\r\n            text: w.text,\r\n            width: (w.bbox.x1 - w.bbox.x0) / scaleFactor,\r\n            height: (w.bbox.y1 - w.bbox.y0) / scaleFactor,\r\n            fontSize: (w.bbox.y1 - w.bbox.y0) / scaleFactor * 0.8, // Approx\r\n            fontFamily: 'Courier',\r\n          });\r\n        });\r\n      }\r\n\r\n      set((state) => ({ editableBlocks: [...state.editableBlocks, ...newBlocks] }));\r\n\r\n    } catch (e) {\r\n      console.error(\"Scan Error:\", e);\r\n    }\r\n  }\r\n}));"],"names":[],"mappings":"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"}},
    {"offset": {"line": 807, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/store/useSettingsStore.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { persist } from 'zustand/middleware';\r\nimport { AppSettings } from '@/types';\r\n\r\ninterface SettingsState {\r\n    settings: AppSettings;\r\n    updateSettings: (newSettings: Partial<AppSettings>) => void;\r\n    toggleTheme: () => void;\r\n}\r\n\r\nconst DEFAULT_SETTINGS: AppSettings = {\r\n    theme: 'light',\r\n    autoCompress: false,\r\n    aiThinking: true,\r\n    permissions: {\r\n        printing: true,\r\n        copying: true,\r\n        modifying: false\r\n    },\r\n    density: 'comfortable',\r\n    defaultPassword: ''\r\n};\r\n\r\nexport const useSettingsStore = create<SettingsState>()(\r\n    persist(\r\n        (set, get) => ({\r\n            settings: DEFAULT_SETTINGS,\r\n            updateSettings: (newValues) => set((state) => {\r\n                const updated = { ...state.settings, ...newValues };\r\n                // Apply theme side-effect\r\n                if (newValues.theme) {\r\n                    const root = document.documentElement;\r\n                    if (newValues.theme === 'dark') {\r\n                        root.classList.add('dark');\r\n                        root.classList.remove('light');\r\n                    } else {\r\n                        root.classList.add('light');\r\n                        root.classList.remove('dark');\r\n                    }\r\n                }\r\n                return { settings: updated };\r\n            }),\r\n            toggleTheme: () => {\r\n                const current = get().settings.theme;\r\n                const next = current === 'light' ? 'dark' : 'light';\r\n                get().updateSettings({ theme: next });\r\n            }\r\n        }),\r\n        {\r\n            name: 'extrapdf_settings_storage',\r\n        }\r\n    )\r\n);\r\n\r\n// Initialize theme on load\r\nconst saved = localStorage.getItem('extrapdf_settings_storage');\r\nif (saved) {\r\n    try {\r\n        const parsed = JSON.parse(saved);\r\n        const theme = parsed.state.settings.theme;\r\n        if (theme === 'dark') document.documentElement.classList.add('dark');\r\n    } catch (e) { }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AASA,MAAM,mBAAgC;IAClC,OAAO;IACP,cAAc;IACd,YAAY;IACZ,aAAa;QACT,UAAU;QACV,SAAS;QACT,WAAW;IACf;IACA,SAAS;IACT,iBAAiB;AACrB;AAEO,MAAM,mBAAmB,IAAA,kQAAM,IAClC,IAAA,wQAAO,EACH,CAAC,KAAK,MAAQ,CAAC;QACX,UAAU;QACV,gBAAgB,CAAC,YAAc,IAAI,CAAC;gBAChC,MAAM,UAAU;oBAAE,GAAG,MAAM,QAAQ;oBAAE,GAAG,SAAS;gBAAC;gBAClD,0BAA0B;gBAC1B,IAAI,UAAU,KAAK,EAAE;oBACjB,MAAM,OAAO,SAAS,eAAe;oBACrC,IAAI,UAAU,KAAK,KAAK,QAAQ;wBAC5B,KAAK,SAAS,CAAC,GAAG,CAAC;wBACnB,KAAK,SAAS,CAAC,MAAM,CAAC;oBAC1B,OAAO;wBACH,KAAK,SAAS,CAAC,GAAG,CAAC;wBACnB,KAAK,SAAS,CAAC,MAAM,CAAC;oBAC1B;gBACJ;gBACA,OAAO;oBAAE,UAAU;gBAAQ;YAC/B;QACA,aAAa;YACT,MAAM,UAAU,MAAM,QAAQ,CAAC,KAAK;YACpC,MAAM,OAAO,YAAY,UAAU,SAAS;YAC5C,MAAM,cAAc,CAAC;gBAAE,OAAO;YAAK;QACvC;IACJ,CAAC,GACD;IACI,MAAM;AACV;AAIR,2BAA2B;AAC3B,MAAM,QAAQ,aAAa,OAAO,CAAC;AACnC,IAAI,OAAO;IACP,IAAI;QACA,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,MAAM,QAAQ,OAAO,KAAK,CAAC,QAAQ,CAAC,KAAK;QACzC,IAAI,UAAU,QAAQ,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;IACjE,EAAE,OAAO,GAAG,CAAE;AAClB"}},
    {"offset": {"line": 875, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/components/ui/SettingsDialog.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from 'react';\r\nimport { X, Moon, Sun, Monitor, Zap, Shield, Lock, Sliders, Check } from 'lucide-react';\r\nimport { useSettingsStore } from '@/store/useSettingsStore';\r\n\r\ninterface SettingsDialogProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nexport const SettingsDialog: React.FC<SettingsDialogProps> = ({ isOpen, onClose }) => {\r\n    const { settings, updateSettings } = useSettingsStore();\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200\">\r\n            <div className=\"bg-white/95 dark:bg-zinc-900/95 backdrop-blur-2xl rounded-2xl shadow-2xl w-full max-w-lg border border-white/20 dark:border-white/10 overflow-hidden flex flex-col max-h-[85vh] animate-in zoom-in-95 duration-200\">\r\n\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-white/10 shrink-0 bg-gray-50/50 dark:bg-black/20\">\r\n                    <h2 className=\"text-lg font-bold flex items-center gap-2\">\r\n                        <Sliders className=\"w-5 h-5 text-primary\" />\r\n                        Settings & Preferences\r\n                    </h2>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 hover:bg-black/5 dark:hover:bg-white/10 rounded-full transition-colors\"\r\n                    >\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Scrollable Content */}\r\n                <div className=\"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar\">\r\n\r\n                    {/* Section 1: Core Logic & AI */}\r\n                    <section className=\"space-y-4\">\r\n                        <div className=\"flex items-center gap-2 text-primary font-bold text-xs uppercase tracking-wider mb-2\">\r\n                            <Zap className=\"w-4 h-4\" /> Workflow Logic\r\n                        </div>\r\n\r\n                        <div className=\"bg-gray-50 dark:bg-white/5 rounded-xl border border-gray-100 dark:border-white/5 overflow-hidden\">\r\n                            <label className=\"flex items-center justify-between p-4 cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors border-b border-gray-100 dark:border-white/5 last:border-0\">\r\n                                <div className=\"space-y-0.5\">\r\n                                    <span className=\"text-sm font-semibold block\">Auto-Compress Exports</span>\r\n                                    <span className=\"text-xs text-muted-foreground block\">Automatically optimize PDF size when saving</span>\r\n                                </div>\r\n                                <div className=\"relative\">\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        checked={settings.autoCompress}\r\n                                        onChange={(e) => updateSettings({ autoCompress: e.target.checked })}\r\n                                        className=\"peer sr-only\"\r\n                                    />\r\n                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary/20 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary\"></div>\r\n                                </div>\r\n                            </label>\r\n\r\n                            <label className=\"flex items-center justify-between p-4 cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors\">\r\n                                <div className=\"space-y-0.5\">\r\n                                    <span className=\"text-sm font-semibold block\">AI Thinking Process</span>\r\n                                    <span className=\"text-xs text-muted-foreground block\">Show step-by-step reasoning in chat sidebar</span>\r\n                                </div>\r\n                                <div className=\"relative\">\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        checked={settings.aiThinking}\r\n                                        onChange={(e) => updateSettings({ aiThinking: e.target.checked })}\r\n                                        className=\"peer sr-only\"\r\n                                    />\r\n                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary/20 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary\"></div>\r\n                                </div>\r\n                            </label>\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Section 2: Security Defaults */}\r\n                    <section className=\"space-y-4\">\r\n                        <div className=\"flex items-center gap-2 text-primary font-bold text-xs uppercase tracking-wider mb-2\">\r\n                            <Shield className=\"w-4 h-4\" /> Security Defaults\r\n                        </div>\r\n\r\n                        <div className=\"bg-gray-50 dark:bg-white/5 rounded-xl border border-gray-100 dark:border-white/5 p-4 space-y-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\r\n                                    <Lock className=\"w-3 h-3\" /> Default Password\r\n                                </label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={settings.defaultPassword}\r\n                                    onChange={(e) => updateSettings({ defaultPassword: e.target.value })}\r\n                                    placeholder=\"Enter a password to pre-fill\"\r\n                                    className=\"w-full bg-white dark:bg-black/20 border border-gray-200 dark:border-white/10 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-semibold uppercase text-muted-foreground\">Default Permissions</label>\r\n                                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\r\n                                    {[\r\n                                        { key: 'printing', label: 'Printing' },\r\n                                        { key: 'copying', label: 'Copying' },\r\n                                        { key: 'modifying', label: 'Modifying' }\r\n                                    ].map((perm) => (\r\n                                        <label key={perm.key} className=\"flex items-center gap-2 p-2 bg-white dark:bg-black/20 rounded-lg border border-gray-200 dark:border-white/10 cursor-pointer hover:border-primary/50 transition-colors\">\r\n                                            <div className={`w-4 h-4 rounded border flex items-center justify-center transition-colors ${settings.permissions[perm.key as keyof typeof settings.permissions] ? 'bg-primary border-primary text-white' : 'border-muted-foreground'}`}>\r\n                                                {settings.permissions[perm.key as keyof typeof settings.permissions] && <Check className=\"w-3 h-3\" />}\r\n                                            </div>\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                className=\"hidden\"\r\n                                                checked={!!settings.permissions[perm.key as keyof typeof settings.permissions]}\r\n                                                onChange={(e) => updateSettings({\r\n                                                    permissions: { ...settings.permissions, [perm.key]: e.target.checked }\r\n                                                })}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium\">{perm.label}</span>\r\n                                        </label>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Section 3: Interface */}\r\n                    <section className=\"space-y-4\">\r\n                        <div className=\"flex items-center gap-2 text-primary font-bold text-xs uppercase tracking-wider mb-2\">\r\n                            <Monitor className=\"w-4 h-4\" /> Interface\r\n                        </div>\r\n\r\n                        <div className=\"bg-gray-50 dark:bg-white/5 rounded-xl border border-gray-100 dark:border-white/5 p-1 flex\">\r\n                            <button\r\n                                onClick={() => updateSettings({ theme: 'light' })}\r\n                                className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-medium transition-all ${settings.theme === 'light' ? 'bg-white shadow text-primary' : 'text-muted-foreground hover:bg-black/5'}`}\r\n                            >\r\n                                <Sun className=\"w-4 h-4\" /> Light\r\n                            </button>\r\n                            <button\r\n                                onClick={() => updateSettings({ theme: 'dark' })}\r\n                                className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-medium transition-all ${settings.theme === 'dark' ? 'bg-zinc-800 shadow text-primary' : 'text-muted-foreground hover:bg-black/5'}`}\r\n                            >\r\n                                <Moon className=\"w-4 h-4\" /> Dark\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"bg-gray-50 dark:bg-white/5 rounded-xl border border-gray-100 dark:border-white/5 p-4 flex items-center justify-between\">\r\n                            <span className=\"text-sm font-semibold\">Density</span>\r\n                            <div className=\"flex bg-white dark:bg-black/20 rounded-lg p-1 border border-gray-200 dark:border-white/10\">\r\n                                <button\r\n                                    onClick={() => updateSettings({ density: 'comfortable' })}\r\n                                    className={`px-3 py-1 text-xs rounded-md transition-all ${settings.density === 'comfortable' ? 'bg-primary text-white shadow-sm' : 'text-muted-foreground hover:text-foreground'}`}\r\n                                >\r\n                                    Comfortable\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => updateSettings({ density: 'compact' })}\r\n                                    className={`px-3 py-1 text-xs rounded-md transition-all ${settings.density === 'compact' ? 'bg-primary text-white shadow-sm' : 'text-muted-foreground hover:text-foreground'}`}\r\n                                >\r\n                                    Compact\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"p-4 border-t border-gray-200 dark:border-white/10 bg-gray-50/50 dark:bg-black/20 shrink-0 text-center\">\r\n                    <p className=\"text-[10px] text-muted-foreground\">\r\n                        Settings are automatically saved to your browser.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1435, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/components/ui/PasswordDialog.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Lock, Unlock, Loader2 } from 'lucide-react';\r\n\r\ninterface PasswordDialogProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onUnlock: (password: string) => Promise<void>;\r\n    fileName: string;\r\n}\r\n\r\nexport const PasswordDialog: React.FC<PasswordDialogProps> = ({ isOpen, onClose, onUnlock, fileName }) => {\r\n    const [password, setPassword] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            await onUnlock(password);\r\n            onClose();\r\n        } catch (err) {\r\n            setError('Incorrect password. Please try again.');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200\">\r\n            <div className=\"bg-white dark:bg-zinc-900 w-full max-w-md p-6 rounded-2xl shadow-xl border border-white/20 scale-100 animate-in zoom-in-95 duration-200\">\r\n                <div className=\"flex flex-col items-center gap-4 text-center\">\r\n                    <div className=\"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center text-red-600 dark:text-red-400\">\r\n                        <Lock className=\"w-6 h-6\" />\r\n                    </div>\r\n                    \r\n                    <div className=\"space-y-1\">\r\n                        <h2 className=\"text-xl font-bold\">Protected Document</h2>\r\n                        <p className=\"text-sm text-muted-foreground break-all\">\r\n                            \"{fileName}\" is encrypted.\r\n                        </p>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"w-full space-y-4 mt-2\">\r\n                        <div className=\"space-y-2 text-left\">\r\n                            <label className=\"text-xs font-semibold uppercase text-muted-foreground ml-1\">Password</label>\r\n                            <input \r\n                                type=\"password\" \r\n                                autoFocus\r\n                                value={password}\r\n                                onChange={(e) => { setPassword(e.target.value); setError(''); }}\r\n                                className=\"w-full p-3 rounded-xl bg-zinc-100 dark:bg-zinc-800 border-2 border-transparent focus:border-primary/50 outline-none transition-all font-mono\"\r\n                                placeholder=\"Enter document password...\"\r\n                            />\r\n                            {error && <p className=\"text-xs text-red-500 font-medium ml-1 animate-in slide-in-from-left-1\">{error}</p>}\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-2 pt-2\">\r\n                             <button \r\n                                type=\"button\" \r\n                                onClick={onClose}\r\n                                className=\"flex-1 px-4 py-3 rounded-xl font-medium hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-muted-foreground\"\r\n                            >\r\n                                Cancel\r\n                            </button>\r\n                            <button \r\n                                type=\"submit\" \r\n                                disabled={!password || isLoading}\r\n                                className=\"flex-1 px-4 py-3 rounded-xl bg-primary text-primary-foreground font-bold shadow-lg shadow-primary/20 hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-50 disabled:pointer-events-none flex items-center justify-center gap-2\"\r\n                            >\r\n                                {isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Unlock className=\"w-4 h-4\" />}\r\n                                Unlock / Force Decrypt\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;;;;;AASO,MAAM,iBAAgD,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE;;IACjG,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wRAAQ,EAAC;IACzC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,wRAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wRAAQ,EAAC;IAEnC,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,aAAa;QACb,SAAS;QACT,IAAI;YACA,MAAM,SAAS;YACf;QACJ,EAAE,OAAO,KAAK;YACV,SAAS;QACb,SAAU;YACN,aAAa;QACjB;IACJ;IAEA,qBACI,4SAAC;QAAI,WAAU;kBACX,cAAA,4SAAC;YAAI,WAAU;sBACX,cAAA,4SAAC;gBAAI,WAAU;;kCACX,4SAAC;wBAAI,WAAU;kCACX,cAAA,4SAAC,iSAAI;4BAAC,WAAU;;;;;;;;;;;kCAGpB,4SAAC;wBAAI,WAAU;;0CACX,4SAAC;gCAAG,WAAU;0CAAoB;;;;;;0CAClC,4SAAC;gCAAE,WAAU;;oCAA0C;oCACjD;oCAAS;;;;;;;;;;;;;kCAInB,4SAAC;wBAAK,UAAU;wBAAc,WAAU;;0CACpC,4SAAC;gCAAI,WAAU;;kDACX,4SAAC;wCAAM,WAAU;kDAA6D;;;;;;kDAC9E,4SAAC;wCACG,MAAK;wCACL,SAAS;wCACT,OAAO;wCACP,UAAU,CAAC;4CAAQ,YAAY,EAAE,MAAM,CAAC,KAAK;4CAAG,SAAS;wCAAK;wCAC9D,WAAU;wCACV,aAAY;;;;;;oCAEf,uBAAS,4SAAC;wCAAE,WAAU;kDAAyE;;;;;;;;;;;;0CAGpG,4SAAC;gCAAI,WAAU;;kDACV,4SAAC;wCACE,MAAK;wCACL,SAAS;wCACT,WAAU;kDACb;;;;;;kDAGD,4SAAC;wCACG,MAAK;wCACL,UAAU,CAAC,YAAY;wCACvB,WAAU;;4CAET,0BAAY,4SAAC,mTAAO;gDAAC,WAAU;;;;;yGAA4B,4SAAC,6SAAM;gDAAC,WAAU;;;;;;4CAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS3H;GAxEa;KAAA"}},
    {"offset": {"line": 1639, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/services/tools/securityTools.ts"],"sourcesContent":["import { PDFDocument } from 'pdf-lib';\r\n\r\nconst load = async (file: File) => await PDFDocument.load(await file.arrayBuffer());\r\n\r\nexport const encryptPdf = async (\r\n    file: File,\r\n    password: string,\r\n    permissions: { printing: boolean, copying: boolean, modifying: boolean } = { printing: true, copying: false, modifying: false }\r\n): Promise<Uint8Array> => {\r\n    // Load source\r\n    const srcDoc = await load(file);\r\n\r\n    // Create destination (fresh doc always has encrypt method)\r\n    const dstDoc = await PDFDocument.create();\r\n\r\n    // Copy all pages\r\n    const indices = srcDoc.getPageIndices();\r\n    const copiedPages = await dstDoc.copyPages(srcDoc, indices);\r\n    copiedPages.forEach(page => dstDoc.addPage(page));\r\n\r\n    // Construct permissions object\r\n    const permObj: any = {\r\n        modifying: !!permissions.modifying,\r\n        copying: !!permissions.copying,\r\n        annotating: !!permissions.modifying,\r\n        fillingForms: !!permissions.modifying,\r\n        contentAccessibility: !!permissions.copying,\r\n        documentAssembly: !!permissions.modifying,\r\n    };\r\n\r\n    if (permissions.printing) {\r\n        permObj.printing = 'highResolution';\r\n    }\r\n\r\n    // Encrypt the fresh document\r\n    (dstDoc as any).encrypt({\r\n        userPassword: password,\r\n        ownerPassword: password,\r\n        permissions: permObj\r\n    });\r\n\r\n    return await dstDoc.save();\r\n};\r\n\r\nexport const flattenPdf = async (file: File): Promise<Uint8Array> => {\r\n    const pdfDoc = await load(file);\r\n    try { pdfDoc.getForm().flatten(); } catch (e) { /* ignore */ }\r\n    return await pdfDoc.save();\r\n};\r\n\r\nexport const updateMetadata = async (file: File, meta: { title?: string, author?: string }): Promise<Uint8Array> => {\r\n    const pdfDoc = await load(file);\r\n    if (meta.title) pdfDoc.setTitle(meta.title);\r\n    if (meta.author) pdfDoc.setAuthor(meta.author);\r\n    return await pdfDoc.save();\r\n};\r\n\r\nexport const checkEncryption = async (file: File): Promise<boolean> => {\r\n    try {\r\n        const arrayBuffer = await file.arrayBuffer();\r\n        const { pdfjs } = await import('react-pdf');\r\n        // Try loading without password\r\n        await pdfjs.getDocument(arrayBuffer).promise;\r\n        return false;\r\n    } catch (error: any) {\r\n        if (error.name === 'PasswordException' || error.password) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n};\r\n\r\nexport const decryptPdf = async (file: File, password: string): Promise<File> => {\r\n    try {\r\n        const arrayBuffer = await file.arrayBuffer();\r\n        // Load with password\r\n        const pdfDoc = await PDFDocument.load(arrayBuffer, { password } as any);\r\n        // Save without any encryption settings (removes it)\r\n        const decryptedBytes = await pdfDoc.save();\r\n\r\n        return new File(\r\n            [decryptedBytes],\r\n            file.name.replace('.pdf', '_decrypted.pdf'),\r\n            { type: 'application/pdf' }\r\n        );\r\n    } catch (e) {\r\n        throw new Error(\"Invalid Password or Decryption Failed\");\r\n    }\r\n};"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;;AAEA,MAAM,OAAO,OAAO,OAAe,MAAM,0NAAW,CAAC,IAAI,CAAC,MAAM,KAAK,WAAW;AAEzE,MAAM,aAAa,OACtB,MACA,UACA,cAA2E;IAAE,UAAU;IAAM,SAAS;IAAO,WAAW;AAAM,CAAC;IAE/H,cAAc;IACd,MAAM,SAAS,MAAM,KAAK;IAE1B,2DAA2D;IAC3D,MAAM,SAAS,MAAM,0NAAW,CAAC,MAAM;IAEvC,iBAAiB;IACjB,MAAM,UAAU,OAAO,cAAc;IACrC,MAAM,cAAc,MAAM,OAAO,SAAS,CAAC,QAAQ;IACnD,YAAY,OAAO,CAAC,CAAA,OAAQ,OAAO,OAAO,CAAC;IAE3C,+BAA+B;IAC/B,MAAM,UAAe;QACjB,WAAW,CAAC,CAAC,YAAY,SAAS;QAClC,SAAS,CAAC,CAAC,YAAY,OAAO;QAC9B,YAAY,CAAC,CAAC,YAAY,SAAS;QACnC,cAAc,CAAC,CAAC,YAAY,SAAS;QACrC,sBAAsB,CAAC,CAAC,YAAY,OAAO;QAC3C,kBAAkB,CAAC,CAAC,YAAY,SAAS;IAC7C;IAEA,IAAI,YAAY,QAAQ,EAAE;QACtB,QAAQ,QAAQ,GAAG;IACvB;IAEA,6BAA6B;IAC5B,OAAe,OAAO,CAAC;QACpB,cAAc;QACd,eAAe;QACf,aAAa;IACjB;IAEA,OAAO,MAAM,OAAO,IAAI;AAC5B;AAEO,MAAM,aAAa,OAAO;IAC7B,MAAM,SAAS,MAAM,KAAK;IAC1B,IAAI;QAAE,OAAO,OAAO,GAAG,OAAO;IAAI,EAAE,OAAO,GAAG,CAAe;IAC7D,OAAO,MAAM,OAAO,IAAI;AAC5B;AAEO,MAAM,iBAAiB,OAAO,MAAY;IAC7C,MAAM,SAAS,MAAM,KAAK;IAC1B,IAAI,KAAK,KAAK,EAAE,OAAO,QAAQ,CAAC,KAAK,KAAK;IAC1C,IAAI,KAAK,MAAM,EAAE,OAAO,SAAS,CAAC,KAAK,MAAM;IAC7C,OAAO,MAAM,OAAO,IAAI;AAC5B;AAEO,MAAM,kBAAkB,OAAO;IAClC,IAAI;QACA,MAAM,cAAc,MAAM,KAAK,WAAW;QAC1C,MAAM,EAAE,KAAK,EAAE,GAAG;QAClB,+BAA+B;QAC/B,MAAM,MAAM,WAAW,CAAC,aAAa,OAAO;QAC5C,OAAO;IACX,EAAE,OAAO,OAAY;QACjB,IAAI,MAAM,IAAI,KAAK,uBAAuB,MAAM,QAAQ,EAAE;YACtD,OAAO;QACX;QACA,OAAO;IACX;AACJ;AAEO,MAAM,aAAa,OAAO,MAAY;IACzC,IAAI;QACA,MAAM,cAAc,MAAM,KAAK,WAAW;QAC1C,qBAAqB;QACrB,MAAM,SAAS,MAAM,0NAAW,CAAC,IAAI,CAAC,aAAa;YAAE;QAAS;QAC9D,oDAAoD;QACpD,MAAM,iBAAiB,MAAM,OAAO,IAAI;QAExC,OAAO,IAAI,KACP;YAAC;SAAe,EAChB,KAAK,IAAI,CAAC,OAAO,CAAC,QAAQ,mBAC1B;YAAE,MAAM;QAAkB;IAElC,EAAE,OAAO,GAAG;QACR,MAAM,IAAI,MAAM;IACpB;AACJ"}},
    {"offset": {"line": 1740, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/Extra-PDF/src/features/home/LandingPage.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { AIInput } from '@/components/ui/AIInput';\r\nimport { useFileStore } from '@/store/useFileStore';\r\nimport { SettingsDialog } from '@/components/ui/SettingsDialog';\r\nimport { FileText, Settings, Upload, Image as ImageIcon, Sparkles } from 'lucide-react';\r\nimport { useRouter } from 'next/navigation';\r\nimport * as Convert from '@/services/tools/convertTools';\r\n\r\n\r\nimport { PasswordDialog } from '@/components/ui/PasswordDialog';\r\nimport { checkEncryption, decryptPdf } from '@/services/tools/securityTools';\r\n\r\nexport const LandingPage: React.FC = () => {\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        // Initialize worker locally\r\n        import('@/utils/pdfWorker').then(({ initPdfWorker }) => initPdfWorker());\r\n    }, []);\r\n    const { setFile } = useFileStore();\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const [isDragOver, setIsDragOver] = useState(false);\r\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n    // Encryption State\r\n    const [passwordDialog, setPasswordDialog] = useState<{ isOpen: boolean, file: File | null }>({ isOpen: false, file: null });\r\n\r\n    const processFiles = async (fileList: FileList | null) => {\r\n        if (!fileList || fileList.length === 0) return;\r\n\r\n        const files = Array.from(fileList);\r\n        setIsProcessing(true);\r\n\r\n        try {\r\n            if (files.length === 1 && files[0].type === 'application/pdf') {\r\n                const file = files[0];\r\n                const isEncrypted = await checkEncryption(file);\r\n\r\n                if (isEncrypted) {\r\n                    setIsProcessing(false);\r\n                    setPasswordDialog({ isOpen: true, file });\r\n                    return;\r\n                }\r\n\r\n                setFile(file);\r\n                router.push('/editor/cursor');\r\n                return;\r\n            }\r\n\r\n            const imageFiles = files.filter(f => f.type.startsWith('image/'));\r\n            if (imageFiles.length > 0) {\r\n                const pdfBytes = await Convert.createPdfFromImages(imageFiles);\r\n                const fileName = imageFiles.length === 1\r\n                    ? imageFiles[0].name.replace(/\\.[^/.]+$/, \"\") + \".pdf\"\r\n                    : \"images_bundle.pdf\";\r\n\r\n                const newFile = new File([pdfBytes], fileName, { type: 'application/pdf' });\r\n                setFile(newFile);\r\n                router.push('/editor/cursor');\r\n                return;\r\n            }\r\n            alert(\"Please upload a PDF or Images \");\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert(\"Error: \" + (error as Error).message);\r\n        } finally {\r\n            setIsProcessing(false);\r\n        }\r\n    };\r\n\r\n    const handleUnlock = async (password: string) => {\r\n        if (!passwordDialog.file) return;\r\n\r\n        // Decrypt and set file\r\n        const decryptedFile = await decryptPdf(passwordDialog.file, password);\r\n        setFile(decryptedFile);\r\n        setPasswordDialog({ isOpen: false, file: null });\r\n        router.push('/editor/cursor');\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen relative overflow-hidden flex flex-col bg-transparent\">\r\n            <input type=\"file\" accept=\".pdf, image/jpeg, image/png\" multiple ref={fileInputRef} onChange={(e) => processFiles(e.target.files)} className=\"hidden\" />\r\n            <SettingsDialog isOpen={isSettingsOpen} onClose={() => setIsSettingsOpen(false)} />\r\n\r\n            <PasswordDialog\r\n                isOpen={passwordDialog.isOpen}\r\n                onClose={() => setPasswordDialog({ isOpen: false, file: null })}\r\n                onUnlock={handleUnlock}\r\n                fileName={passwordDialog.file?.name || 'Document'}\r\n            />\r\n\r\n            {/* Decorative Elements */}\r\n            <div className=\"fixed top-[-20%] left-[-10%] w-[800px] h-[800px] bg-red-500/10 rounded-full blur-[120px] pointer-events-none animate-pulse\" />\r\n            <div className=\"fixed bottom-[-20%] right-[-10%] w-[600px] h-[600px] bg-orange-500/10 rounded-full blur-[100px] pointer-events-none\" />\r\n\r\n            {/* Header */}\r\n            <header className=\"relative z-10 px-6 py-6 flex justify-between items-center max-w-7xl mx-auto w-full\">\r\n                <div className=\"flex items-center gap-3 p-2 pr-4 rounded-2xl bg-white/30 dark:bg-black/30 backdrop-blur-md border border-white/20 shadow-sm\">\r\n                    <div className=\"w-10 h-10 bg-gradient-to-tr from-red-600 to-orange-500 rounded-xl flex items-center justify-center shadow-lg\">\r\n                        <FileText className=\"text-white w-6 h-6\" />\r\n                    </div>\r\n                    <span className=\"text-xl font-bold tracking-tight\">ExtraPDF</span>\r\n                </div>\r\n                <button onClick={() => setIsSettingsOpen(true)} className=\"p-3 rounded-full bg-white/30 dark:bg-black/30 backdrop-blur-md border border-white/20 hover:bg-white/50 transition-all\">\r\n                    <Settings className=\"w-5 h-5\" />\r\n                </button>\r\n            </header>\r\n\r\n            {/* Main */}\r\n            <main className=\"flex-1 flex flex-col items-center justify-center px-4 relative z-10 max-w-5xl mx-auto w-full gap-8\">\r\n                <div className=\"text-center space-y-4 animate-in slide-in-from-bottom-8 duration-700\">\r\n                    <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold uppercase tracking-wider mb-2\">\r\n                        <Sparkles className=\"w-3 h-3\" /> AI Powered Editor\r\n                    </div>\r\n                    <h1 className=\"text-5xl md:text-7xl font-bold tracking-tighter drop-shadow-sm\">\r\n                        Contextual <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-orange-600\">Intelligence</span>\r\n                    </h1>\r\n                    <p className=\"text-lg md:text-2xl text-muted-foreground/80 max-w-2xl mx-auto font-light leading-relaxed\">\r\n                        Chat with your documents, edit text, and organize pages magically \r\n                    </p>\r\n                </div>\r\n\r\n                {/* Drop Zone */}\r\n                <div\r\n                    onDragOver={(e) => { e.preventDefault(); setIsDragOver(true); }}\r\n                    onDragLeave={() => setIsDragOver(false)}\r\n                    onDrop={(e) => { e.preventDefault(); setIsDragOver(false); processFiles(e.dataTransfer.files); }}\r\n                    onClick={() => fileInputRef.current?.click()}\r\n                    className={`\r\n                w-full max-w-2xl aspect-[3/1] rounded-[2.5rem] border-2 border-dashed transition-all duration-300 cursor-pointer\r\n                flex flex-col items-center justify-center gap-4 group backdrop-blur-xl shadow-2xl relative overflow-hidden\r\n                ${isDragOver\r\n                            ? 'border-primary bg-primary/10 scale-105 shadow-primary/20'\r\n                            : 'border-white/20 bg-white/40 dark:bg-black/20 hover:bg-white/50 hover:border-primary/30'\r\n                        }\r\n            `}\r\n                >\r\n                    {isProcessing ? (\r\n                        <div className=\"flex flex-col items-center gap-3 animate-pulse text-primary\">\r\n                            <ImageIcon className=\"w-12 h-12\" />\r\n                            <span className=\"font-bold text-lg\">Crunching pixels... </span>\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            <div className={`\r\n                        p-6 rounded-full shadow-lg transition-transform duration-500\r\n                        ${isDragOver ? 'bg-primary text-white scale-110' : 'bg-white text-foreground group-hover:scale-110'}\r\n                    `}>\r\n                                <Upload className=\"w-8 h-8\" />\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                                <p className=\"font-bold text-lg\">Drop PDF or Images</p>\r\n                                <p className=\"text-xs text-muted-foreground mt-1\">Combine multiple files instantly</p>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Floating Input */}\r\n                <div className=\"fixed bottom-8 w-full max-w-xl px-4 z-50 animate-in slide-in-from-bottom-10 delay-300\">\r\n                    <AIInput onSubmit={() => fileInputRef.current?.click()} placeholder=\"Ask to summarize or edit a document...\" />\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n};"],"names":[],"mappings":"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"}}]
}